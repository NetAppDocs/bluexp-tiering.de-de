---
sidebar: sidebar 
permalink: task-tiering-onprem-azure.html 
keywords: data tiering, fabricpool, cloud tiering, tiering cold data, tiering inactive data, tiering aff, tiering fas, tiering ontap, tiering volumes, tier data, tier cold data, tier fas, tier aff, tier ontap, azure, blob, azure blob 
summary: Durch das Tiering inaktiver Daten in Azure Blob Storage entsteht freier Speicherplatz auf ONTAP Clustern vor Ort. 
---
= Tiering von Daten von lokalen ONTAP Clustern zu Azure Blob Storage
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Durch das Tiering inaktiver Daten in Azure Blob Storage entsteht freier Speicherplatz auf ONTAP Clustern vor Ort.



== Schnellstart

Führen Sie diese Schritte schnell durch, oder scrollen Sie nach unten zu den verbleibenden Abschnitten, um ausführliche Informationen zu erhalten.

.image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-1.png["Eins"] Vorbereiten von Daten auf Azure Blob Storage
[role="quick-margin-para"]
Sie benötigen Folgendes:

[role="quick-margin-list"]
* Ein ONTAP-Cluster vor Ort, der ONTAP 9.4 oder höher ausführt und über eine HTTPS-Verbindung zum Azure Blob-Storage verfügt. https://docs.netapp.com/us-en/bluexp-ontap-onprem/task-discovering-ontap.html["Entdecken Sie ein Cluster"^].
* Ein Connector, der in einer Azure vnet oder vor Ort installiert ist.
* Networking eines Connectors, der eine HTTPS-ausgehende Verbindung zum ONTAP Cluster in Ihrem Datacenter, zum Azure Storage und zum BlueXP Tiering Service ermöglicht.


.image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-2.png["Zwei"] Tiering einrichten
[role="quick-margin-para"]
Wählen Sie in BlueXP eine lokale ONTAP-Arbeitsumgebung aus, klicken Sie für den Tiering Service auf *Aktivieren* und folgen Sie den Aufforderungen zum Tiering von Daten auf Azure Blob Storage.

.image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-3.png["Drittens"] Lizenzierung einrichten
[role="quick-margin-para"]
Nach Ablauf der kostenlosen Testversion können Sie für BlueXP Tiering über ein Pay-as-you-go-Abonnement, eine ONTAP BlueXP Tiering-BYOL-Lizenz oder eine Kombination aus beiden Optionen bezahlen:

[role="quick-margin-list"]
* Für eine Anmeldung über den Azure Marketplace: https://azuremarketplace.microsoft.com/en-us/marketplace/apps/netapp.cloud-manager?tab=Overview["Rufen Sie das BlueXP Marketplace Angebot auf"^]Klicken Sie auf *Abonnieren*, und folgen Sie dann den Anweisungen.
* Für die Zahlung mit einer BlueXP Tiering-BYOL-Lizenz mailto:ng-cloud-tiering@netapp.com?subject=Licensing[Wsetzen Sie sich mit uns in Verbindung] und dann link:task-licensing-cloud-tiering.html#add-bluexp-tiering-byol-licenses-to-your-account["Erweitern Sie Ihr Konto über das Digital Wallet von BlueXP"].




== Anforderungen

Überprüfen Sie die Unterstützung für Ihr ONTAP Cluster, richten Sie Ihr Netzwerk ein und bereiten Sie den Objekt-Storage vor.

Die folgende Abbildung zeigt die einzelnen Komponenten und die Verbindungen, die zwischen den Komponenten vorbereitet werden müssen:

image:diagram_cloud_tiering_azure.png["Architekturbild: BlueXP Tiering-Service mit einer Verbindung zum Connector in Ihrem Cloud-Provider, den Connector mit einer Verbindung zu Ihrem ONTAP-Cluster und eine Verbindung zwischen dem ONTAP-Cluster und Objektspeicher Ihres Cloud-Providers. Aktive Daten befinden sich auf dem ONTAP Cluster, während sich inaktive Daten im Objekt-Storage befinden."]


NOTE: Die Kommunikation zwischen dem Connector und Blob-Storage dient ausschließlich der Objekt-Storage-Einrichtung. Der Connector kann lokal statt in der Cloud residieren.



=== Vorbereiten der ONTAP Cluster

Ihre ONTAP-Cluster müssen beim Tiering von Daten zu Azure Blob Storage die folgenden Anforderungen erfüllen:

Unterstützte ONTAP Plattformen::
+
--
* Bei Verwendung von ONTAP 9.8 und höher können Daten von AFF Systemen oder FAS Systemen mit reinen SSD-Aggregaten oder rein HDD-basierten Aggregaten verschoben werden.
* Bei Verwendung von ONTAP 9.7 und früher können Sie Daten von AFF Systemen oder FAS Systemen mit reinen SSD-Aggregaten verschieben.


--
Unterstützte ONTAP Version:: ONTAP 9.4 oder höher
Netzwerkanforderungen für Cluster::
+
--
* Das ONTAP Cluster initiiert eine HTTPS-Verbindung über Port 443 zum Azure Blob Storage.
+
ONTAP liest und schreibt Daten auf und aus dem Objekt-Storage. Objekt-Storage startet nie, er reagiert einfach nur.

+
ExpressRoute bietet zwar eine bessere Performance und niedrigere Datentransferkosten, er ist jedoch nicht zwischen dem ONTAP Cluster und Azure Blob Storage erforderlich. Aber das ist die empfohlene Best Practice.

* Eine eingehende Verbindung ist über den Connector erforderlich, der in einem Azure vnet oder vor Ort residieren kann.
+
Es ist keine Verbindung zwischen dem Cluster und dem BlueXP Tiering Service erforderlich.

* Für jeden ONTAP Node ist eine Intercluster-LIF erforderlich, die die Volumes hostet, die Sie abstufen möchten. Die LIF muss dem _IPspace_ zugewiesen sein, den ONTAP zur Verbindung mit Objekt-Storage verwenden sollte.
+
Beim Einrichten von Daten-Tiering fordert BlueXP Tiering Sie zur Verwendung des IPspaces auf. Sie sollten den IPspace auswählen, dem jede LIF zugeordnet ist. Dies kann der „Standard“-IPspace oder ein benutzerdefinierter IPspace sein, den Sie erstellt haben. Weitere Informationen zu https://docs.netapp.com/us-en/ontap/networking/create_a_lif.html["LIFs"^] Und https://docs.netapp.com/us-en/ontap/networking/standard_properties_of_ipspaces.html["IPspaces"^].



--
Unterstützte Volumes und Aggregate:: Die Gesamtzahl der Volumes, die BlueXP Tiering durchführen kann, kann kleiner sein als die Anzahl der Volumes auf Ihrem ONTAP System. Das liegt daran, dass Volumes von einigen Aggregaten nicht abgestuft werden können. In der ONTAP-Dokumentation finden Sie Informationen zu https://docs.netapp.com/us-en/ontap/fabricpool/requirements-concept.html#functionality-or-features-not-supported-by-fabricpool["Funktionalität oder Funktionen, die nicht von FabricPool unterstützt werden"^].



NOTE: BlueXP Tiering unterstützt FlexGroup Volumes ab ONTAP 9.5. Setup funktioniert wie jedes andere Volume.



=== Ermitteln eines ONTAP-Clusters

Bevor Sie mit dem Tiering selten genutzter Daten beginnen können, müssen Sie eine lokale ONTAP-Arbeitsumgebung in BlueXP schaffen.

https://docs.netapp.com/us-en/bluexp-ontap-onprem/task-discovering-ontap.html["Entdecken Sie ein Cluster"^].



=== Erstellen oder Umschalten von Anschlüssen

Für das Tiering von Daten in die Cloud ist ein Connector erforderlich. Beim Tiering von Daten in den Azure Blob Storage können Sie einen Connector verwenden, der sich in einer Azure vnet oder in Ihrem Standort befindet. Entweder müssen Sie einen neuen Konnektor erstellen oder sicherstellen, dass der aktuell ausgewählte Connector in Azure oder On-Prem liegt.

* https://docs.netapp.com/us-en/bluexp-setup-admin/concept-connectors.html["Erfahren Sie mehr über Steckverbinder"^]
* https://docs.netapp.com/us-en/bluexp-setup-admin/task-quick-start-connector-azure.html["Implementieren eines Connectors in Azure"^]
* https://docs.netapp.com/us-en/bluexp-setup-admin/task-quick-start-connector-on-prem.html["Installieren eines Connectors auf einem Linux-Host"^]




=== Stellen Sie sicher, dass Sie über die erforderlichen Connector-Berechtigungen verfügen

Wenn Sie den Connector mit BlueXP Version 3.9.25 oder höher erstellt haben, sind Sie alle festgelegt. Standardmäßig wird die benutzerdefinierte Rolle eingerichtet, die die Berechtigungen bereitstellt, die ein Connector zur Verwaltung von Ressourcen und Prozessen in Ihrem Azure-Netzwerk benötigt. Siehe https://docs.netapp.com/us-en/bluexp-setup-admin/reference-permissions-azure.html#custom-role-permissions["Erforderliche Berechtigungen für benutzerdefinierte Rollen"^] Und das https://docs.netapp.com/us-en/bluexp-setup-admin/reference-permissions-azure.html#cloud-tiering["Für BlueXP Tiering sind spezifische Berechtigungen erforderlich"^].

Wenn Sie den Connector mit einer früheren Version von BlueXP erstellt haben, müssen Sie die Berechtigungsliste für das Azure-Konto bearbeiten, um fehlende Berechtigungen hinzuzufügen.



=== Vorbereiten der Vernetzung für den Connector

Stellen Sie sicher, dass der Connector über die erforderlichen Netzwerkverbindungen verfügt. Ein Connector kann lokal oder in Azure installiert werden.

.Schritte
. Stellen Sie sicher, dass das Netzwerk, in dem der Connector installiert ist, folgende Verbindungen ermöglicht:
+
** Eine HTTPS-Verbindung über Port 443 zum BlueXP Tiering Service und zu Ihrem Azure Blob Objekt-Storage (https://docs.netapp.com/us-en/bluexp-setup-admin/task-set-up-networking-azure.html#endpoints-contacted-for-day-to-day-operations["Siehe die Liste der Endpunkte"^])
** Eine HTTPS-Verbindung über Port 443 an Ihre ONTAP-Cluster-Management-LIF


. Aktivieren Sie bei Bedarf einen vnet-Service-Endpunkt zum Azure Storage.
+
Wenn Sie über eine ExpressRoute oder eine VPN-Verbindung zwischen Ihrem ONTAP Cluster und dem vnet verfügen, wird ein vnet-Service-Endpunkt zum Azure Storage empfohlen, um in Ihrem virtuellen privaten Netzwerk die Kommunikation zwischen Connector und Blob-Storage zu bestehen.





=== Azure Blob Storage wird vorbereitet

Wenn Sie Tiering einrichten, müssen Sie die Ressourcengruppe, die Sie verwenden möchten, sowie das Storage-Konto und den Azure-Container identifizieren, die zur Ressourcengruppe gehören. Ein Storage-Konto ermöglicht BlueXP Tiering zur Authentifizierung und zum Zugriff auf den für das Daten-Tiering verwendeten Blob-Container.

BlueXP Tiering unterstützt Tiering zu jedem Storage-Konto in einer Region, auf das über den Connector zugegriffen werden kann.

BlueXP Tiering unterstützt nur die Storage-Konten der Typen General Purpose v2 und Premium Block Blob.


NOTE: Wenn Sie BlueXP Tiering konfigurieren möchten, um eine kostengünstigere Zugriffsebene zu verwenden, auf die Ihre Tiering-Daten nach einer bestimmten Anzahl von Tagen verschoben werden, dürfen Sie beim Einrichten des Containers in Ihrem Azure-Konto keine Lebenszyklusregeln auswählen. BlueXP Tiering managt die Lebenszyklusumstellungen.



== Tiering inaktiver Daten von dem ersten Cluster zu Azure Blob Storage

Starten Sie nach der Vorbereitung der Azure Umgebung das Tiering inaktiver Daten aus dem ersten Cluster.

.Was Sie benötigen
https://docs.netapp.com/us-en/bluexp-ontap-onprem/task-discovering-ontap.html["Eine Arbeitsumgebung vor Ort"^].

.Schritte
. Wählen Sie die lokale ONTAP-Arbeitsumgebung aus.
. Klicken Sie im rechten Fenster auf *enable* für den Tiering-Dienst.
+
Wenn das Tiering-Ziel für Azure Blob als eine Arbeitsumgebung auf dem Canvas existiert, können Sie das Cluster auf die Azure Blob Arbeitsumgebung ziehen, um den Setup-Assistenten zu starten.

+
image:screenshot_setup_tiering_onprem.png["Ein Screenshot, der die Aktivieren-Option auf der rechten Seite des Bildschirms zeigt, nachdem Sie eine lokale ONTAP-Arbeitsumgebung ausgewählt haben."]

. *Objekt-Speichername definieren*: Geben Sie einen Namen für diesen Objekt-Speicher ein. Er muss von jedem anderen Objekt-Storage, den Sie mit Aggregaten auf diesem Cluster verwenden können, eindeutig sein.
. *Anbieter auswählen*: Wählen Sie *Microsoft Azure* und klicken Sie auf *Weiter*.
. Führen Sie die Schritte auf den Seiten *Objektspeicherung erstellen* aus:
+
.. *Ressourcengruppe*: Wählen Sie eine Ressourcengruppe aus, in der ein vorhandener Container verwaltet wird oder wo Sie einen neuen Container für Tiered-Daten erstellen möchten, und klicken Sie auf *Weiter*.
+
Bei der Verwendung eines On-Prem-Connectors müssen Sie das Azure-Abonnement eingeben, das den Zugriff auf die Ressourcengruppe ermöglicht.

.. *Azure Container*: Wählen Sie das Optionsfeld, um entweder einen neuen Blob-Container zu einem Speicherkonto hinzuzufügen oder einen bestehenden Container zu verwenden. Wählen Sie dann das Speicherkonto aus und wählen Sie den vorhandenen Container aus, oder geben Sie den Namen für den neuen Container ein. Klicken Sie dann auf *Weiter*.
+
Die in diesem Schritt angezeigten Speicherkonten und Container gehören zur Ressourcengruppe, die Sie im vorherigen Schritt ausgewählt haben.

.. *Access Tier Life Cycle*: BlueXP Tiering managt die Lebenszyklusübergänge Ihrer Tiering-Daten. Daten beginnen in der Klasse _Hot_, Sie können jedoch eine Regel erstellen, um die Daten nach einer bestimmten Anzahl von Tagen in die Klasse _Cool_ zu verschieben.
+
Wählen Sie die Zugriffsebene, in die Sie die gestaffelten Daten übertragen möchten, und die Anzahl der Tage vor dem Verschieben der Daten aus, und klicken Sie auf *Weiter*. Beispiel: Der Screenshot unten zeigt, dass Tiered Daten nach 45 Tagen im Objekt-Storage von der Klasse _Hot_ in die Klasse _Cool_ verschoben werden.

+
Wenn Sie *Daten in dieser Zugriffsebene* aufbewahren, verbleiben die Daten in der Zugriffsebene _Hot_ und es werden keine Regeln angewendet. link:reference-azure-support.html["Siehe Unterstützte Zugriffsebenen"^].

+
image:screenshot_tiering_lifecycle_selection_azure.png["Ein Screenshot zeigt, wie Sie eine andere Zugriffsebene auswählen, in der Daten nach einer bestimmten Anzahl von Tagen verschoben werden."]

+
Beachten Sie, dass die Lebenszyklusregel auf alle Blob-Container im ausgewählten Speicherkonto angewendet wird.

.. *Clusternetzwerk*: Wählen Sie den IPspace aus, den ONTAP verwenden soll, um eine Verbindung zum Objekt-Storage herzustellen, und klicken Sie auf *Weiter*.
+
Durch Auswahl des passenden IPspaces wird sichergestellt, dass BlueXP Tiering eine Verbindung von ONTAP zu dem Objekt-Storage Ihres Cloud-Providers herstellen kann.

+
Sie können auch die verfügbare Netzwerkbandbreite zum Hochladen inaktiver Daten in den Objektspeicher festlegen, indem Sie die „maximale Übertragungsrate“ festlegen. Wählen Sie das Optionsfeld *begrenzt* und geben Sie die maximale Bandbreite ein, die verwendet werden kann, oder wählen Sie *unbegrenzt*, um anzuzeigen, dass keine Begrenzung vorhanden ist.



. Wählen Sie auf der Seite „_Tier Volumes_“ die Volumes aus, für die Sie Tiering konfigurieren möchten, und starten Sie die Seite „Tiering Policy“:
+
** Um alle Volumes auszuwählen, aktivieren Sie das Kontrollkästchen in der Titelzeile (image:button_backup_all_volumes.png[""]) Und klicken Sie auf *Volumes konfigurieren*.
** Wenn Sie mehrere Volumes auswählen möchten, aktivieren Sie das Kontrollkästchen für jedes Volume (image:button_backup_1_volume.png[""]) Und klicken Sie auf *Volumes konfigurieren*.
** Um ein einzelnes Volume auszuwählen, klicken Sie auf die Zeile (oder) image:screenshot_edit_icon.gif["Bleistiftsymbol bearbeiten"] Symbol) für das Volume.
+
image:screenshot_tiering_initial_volumes.png["Ein Screenshot, in dem die Auswahl eines einzelnen Volumes, mehrerer Volumes oder aller Volumes und die Schaltfläche Ausgewählte Volumes ändern angezeigt werden."]



. Wählen Sie im Dialogfeld _Tiering Policy_ eine Tiering Policy aus, passen Sie optional die Kühltage für die ausgewählten Volumes an und klicken Sie auf *Apply*.
+
link:concept-cloud-tiering.html#volume-tiering-policies["Erfahren Sie mehr über Volume Tiering-Richtlinien und Kühltage"].

+
image:screenshot_tiering_initial_policy_settings.png["Ein Screenshot, der die konfigurierbaren Tiering-Richtlinieneinstellungen anzeigt."]



.Ergebnis
Sie haben Daten-Tiering von Volumes auf dem Cluster erfolgreich in den Azure Blob Objekt-Storage eingerichtet.

.Was kommt als Nächstes?
link:task-licensing-cloud-tiering.html["Abonnieren Sie unbedingt den BlueXP Tiering Service"].

Sie können Informationen zu den aktiven und inaktiven Daten auf dem Cluster anzeigen. link:task-managing-tiering.html["Erfahren Sie mehr über das Managen Ihrer Tiering-Einstellungen"].

Sie können auch zusätzlichen Objekt-Storage erstellen, wenn Sie Daten von bestimmten Aggregaten auf einem Cluster in verschiedene Objektspeicher verschieben möchten. Falls Sie FabricPool Mirroring verwenden möchten, wo Ihre Tiered-Daten in einen zusätzlichen Objektspeicher repliziert werden. link:task-managing-object-storage.html["Erfahren Sie mehr über die Verwaltung von Objektspeichern"].
